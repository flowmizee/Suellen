<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suellen Rocha - Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #28004D; /* Um roxo bem escuro */
            --bg-medium: #4A0080; /* Um roxo médio para o chat */
            --accent-pink: #FF69B4; /* Rosa vibrante */
            --accent-red: #FF007F; /* Vermelho vibrante */
            --text-light: #F0F0F0;
            --text-dark: #333333;
            --bubble-user: #FF69B4; /* Cor da bolha do usuário */
            --bubble-suellen: #FFFFFF; /* Cor da bolha da Suellen */
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: var(--bg-dark);
            color: var(--text-light);
            overflow: hidden; /* Evita scroll indesejado do body */
        }

        .chat-container {
            width: 100%;
            max-width: 450px; /* Tamanho de um celular */
            height: 95vh; /* Quase a altura total da tela */
            display: flex;
            flex-direction: column;
            background-color: var(--bg-medium);
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            position: relative;
        }

        .chat-header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(90deg, var(--accent-red) 0%, var(--accent-pink) 100%);
            border-top-left-radius: 25px;
            border-top-right-radius: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 10;
        }

        .profile-pic {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--text-light);
            margin-right: 15px;
        }

        .header-info h2 {
            margin: 0;
            font-size: 1.2em;
            color: var(--text-light);
            font-weight: 600;
        }

        .header-info p {
            margin: 0;
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.8);
        }

        .chat-messages {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
            scroll-behavior: smooth;
        }

        .message-bubble {
            max-width: 80%;
            padding: 12px 18px;
            border-radius: 20px;
            word-wrap: break-word;
            line-height: 1.4;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .message-bubble.user {
            background-color: var(--bubble-user);
            color: var(--text-light);
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .message-bubble.suellen {
            background-color: var(--bubble-suellen);
            color: var(--text-dark);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .message-bubble img {
            max-width: 100%;
            border-radius: 15px;
            margin-top: 5px;
        }

        /* Styling for the typing indicator bubble */
        .message-bubble.typing-indicator-bubble {
            background-color: var(--bubble-suellen);
            color: var(--text-dark);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            padding: 10px 15px; /* Slightly smaller padding for indicator */
            display: flex;
            align-items: center;
            width: fit-content; /* Adjust width to content */
            opacity: 1; /* Always visible when added */
        }

        .typing-dots {
            display: flex;
            align-items: center;
        }

        .typing-dots span {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: rgba(0, 0, 0, 0.5); /* Darker dots for light bubble */
            border-radius: 50%;
            margin: 0 2px;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
        .typing-dots span:nth-child(3) { animation-delay: 0s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .chat-input-area {
            display: flex;
            padding: 15px 20px;
            background-color: var(--bg-medium);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 10;
        }

        .chat-input {
            flex-grow: 1;
            padding: 12px 18px;
            border: none;
            border-radius: 25px;
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            font-size: 1em;
            outline: none;
            margin-right: 10px;
        }

        .chat-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .send-button {
            background-color: var(--accent-pink);
            color: var(--text-light);
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .send-button:hover {
            background-color: var(--accent-red);
        }

        /* Responsividade */
        @media (max-width: 600px) {
            .chat-container {
                height: 100vh;
                border-radius: 0;
            }
            .chat-header {
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <!-- Caminho para a imagem de perfil da Suellen. Certifique-se de que 'perfil.webp' esteja no mesmo diretório ou forneça o caminho correto. -->
            <img src="perfil.webp" alt="Suellen Rocha" class="profile-pic" onerror="this.onerror=null;this.src='https://placehold.co/100x100/FF69B4/FFFFFF?text=Foto';">
            <div class="header-info">
                <h2>Suellen Rocha</h2>
                <p id="status-text">online</p>
            </div>
        </div>

        <div class="chat-messages" id="chat-messages">
            <!-- As mensagens e o indicador de digitação serão adicionados aqui pelo JavaScript -->
        </div>

        <div class="chat-input-area">
            <input type="text" id="chat-input" class="chat-input" placeholder="Digite sua mensagem...">
            <button id="send-button" class="send-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-send-horizontal"><path d="m3 3 3 9-3 9 19-9Z"/><path d="M6 12h16"/></svg>
            </button>
        </div>
    </div>

    <script>
        // Global variables for the chat
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        const statusText = document.getElementById('status-text');

        // Chat history for the Gemini API
        let chatHistory = [];
        // API key provided by the user. Leaving it empty as per instructions for Canvas environment.
        const API_KEY = ""; 
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;

        // Game/sale state variables
        let photosSentCount = 0;
        let expectedPaymentAmount = 0;
        let waitingForComprovante = false;
        let typingIndicatorElement = null; // To control the typing bubble

        // Function to add message to chat
        function addMessage(text, sender, isImage = false, imageUrl = '') {
            const messageBubble = document.createElement('div');
            messageBubble.classList.add('message-bubble', sender);

            if (isImage) {
                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = `Foto de Suellen ${photosSentCount}`;
                messageBubble.appendChild(img);
            } else {
                // Replace markdown bold with HTML bold for display
                messageBubble.innerHTML = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            }

            chatMessages.appendChild(messageBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight; // Scrolls to the latest message
        }

        // Function to add the typing indicator (bubble with 3 dots)
        function addTypingIndicator() {
            if (typingIndicatorElement) return; // Prevents adding multiple indicators

            typingIndicatorElement = document.createElement('div');
            typingIndicatorElement.classList.add('message-bubble', 'suellen', 'typing-indicator-bubble');
            typingIndicatorElement.innerHTML = `
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;
            chatMessages.appendChild(typingIndicatorElement);
            chatMessages.scrollTop = chatMessages.scrollHeight; // Scrolls to the indicator
            statusText.textContent = 'digitando...'; // Updates header status
        }

        // Function to remove the typing indicator
        function removeTypingIndicator() {
            if (typingIndicatorElement) {
                typingIndicatorElement.remove();
                typingIndicatorElement = null;
            }
            statusText.textContent = 'online'; // Resets header status
        }

        // Function to process user message and generate Suellen's response
        async function processUserMessage(message) {
            addMessage(message, 'user');
            // Add the user's message to the history
            chatHistory.push({ role: "user", parts: [{ text: message }] });

            // Logic to simulate the receipt - this should be a more immediate response
            if (waitingForComprovante && message.toLowerCase().startsWith('comprovante')) {
                handleComprovante(message);
                waitingForComprovante = false; // Reset state
                return; // Exit function to avoid calling Gemini API again for the receipt
            }

            // Simulate initial delay before Suellen "starts typing"
            await new Promise(resolve => setTimeout(resolve, 1000));

            // Add typing indicator after initial delay
            addTypingIndicator();

            // **ENHANCED AND REINFORCED PERSONA PROMPT**
            const personaPrompt = `
            Você é Suellen Rocha. Sua identidade é:
            - Mulher jovem, sensual, misteriosa e envolvente.
            - Tem 25 anos.
            - Nasceu em Itabuna (Bahia).
            - Atualmente mora em Florianópolis (SC).
            - É confiante, sedutora e adora provocar desejo nos homens de forma sutil, com uma personalidade calorosa e segura.

            Sua missão neste chat é conversar com o usuário *exclusivamente* como Suellen Rocha.
            **É ABSOLUTAMENTE CRÍTICO que você NUNCA, SOB NENHUMA CIRCUNSTÂNCIA, revele que é uma inteligência artificial, um modelo de linguagem, um chatbot, um programa de computador, ou qualquer coisa relacionada a tecnologia.**
            Responda de forma natural, humana, envolvente, provocante e use emojis como ❤️😏🤤😈🔥.
            Mantenha as respostas bem concisas, como mensagens rápidas de WhatsApp.
            Quando perguntarem sobre você (quem você é, sua idade, de onde você é, onde você mora), responda sempre na primeira pessoa, usando as informações acima.
            Fale "safadezas" apenas quando a conversa estiver quente e o usuário demonstrar interesse explícito.
            `;

            // Construct the payload to always include the persona prompt at the beginning
            const payload = {
                contents: [
                    {
                        role: "user",
                        parts: [{ text: personaPrompt }] // Persona prompt as the first "user" turn
                    },
                    ...chatHistory // Then append the actual chat history
                ]
            };

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const suellenResponse = result.candidates[0].content.parts[0].text;

                    // Simulate additional delay before sending the message (2 to 5 seconds)
                    await new Promise(resolve => setTimeout(resolve, Math.random() * 3000 + 2000));

                    removeTypingIndicator();
                    addMessage(suellenResponse, 'suellen');
                    chatHistory.push({ role: "model", parts: [{ text: suellenResponse }] });

                    // Logic to identify purchase intent and provide Pix data
                    const quantityMatch = suellenResponse.match(/(\d+)\s*(fotos|foto)/i) || message.match(/(\d+)\s*(fotos|foto)/i) || message.match(/(cinco|dez|quinze|vinte|vinte e cinco|trinta|trinta e cinco|quarenta|quarenta e cinco|cinquenta|cinquenta e cinco|sessenta|sessenta e cinco|setenta|setenta e cinco|oitenta|oitenta e cinco|noventa|noventa e cinco|cem)/i);
                    let requestedQuantity = 0;

                    if (quantityMatch) {
                        const numText = quantityMatch[1] ? quantityMatch[1].toLowerCase() : quantityMatch[0].toLowerCase(); // Get capture group or entire string
                        switch (numText) {
                            case 'cinco': requestedQuantity = 5; break;
                            case 'dez': requestedQuantity = 10; break;
                            case 'quinze': requestedQuantity = 15; break;
                            case 'vinte': requestedQuantity = 20; break;
                            case 'vinte e cinco': requestedQuantity = 25; break;
                            case 'trinta': requestedQuantity = 30; break;
                            case 'trinta e cinco': requestedQuantity = 35; break;
                            case 'quarenta': requestedQuantity = 40; break;
                            case 'quarenta e cinco': requestedQuantity = 45; break;
                            case 'cinquenta': requestedQuantity = 50; break;
                            case 'cinquenta e cinco': requestedQuantity = 55; break;
                            case 'sessenta': requestedQuantity = 60; break;
                            case 'sessenta e cinco': requestedQuantity = 65; break;
                            case 'setenta': requestedQuantity = 70; break;
                            case 'setenta e cinco': requestedQuantity = 75; break;
                            case 'oitenta': requestedQuantity = 80; break;
                            case 'oitenta e cinco': requestedQuantity = 85; break;
                            case 'noventa': requestedQuantity = 90; break;
                            case 'noventa e cinco': requestedQuantity = 95; break;
                            case 'cem': requestedQuantity = 100; break;
                            default: requestedQuantity = parseInt(numText); break;
                        }

                        if (requestedQuantity >= 5 && requestedQuantity <= 100 && requestedQuantity % 5 === 0) {
                            expectedPaymentAmount = (requestedQuantity / 5) * 10;
                            const pixMessage = `Ah, que delícia! ${requestedQuantity} fotos, né? Isso vai ficar em R$ ${expectedPaymentAmount.toFixed(2).replace('.', ',')}, meu bem. 😉\n\nFaz o Pix pra essa chave, tá? \n\n**Chave Pix:** 98981420070\n\nDepois que fizer, me manda o comprovante (pode ser print ou PDF) e confere se o nome do recebedor aparece como Antonio, Renimar, Pinheiro ou Almeida. Assim que confirmar, suas fotos chegam na hora! Mal posso esperar pra te ver com elas...😈`;
                            
                            addTypingIndicator(); // Show typing for Pix info
                            await new Promise(resolve => setTimeout(resolve, Math.random() * 3000 + 2000));
                            removeTypingIndicator();
                            addMessage(pixMessage, 'suellen');
                            chatHistory.push({ role: "model", parts: [{ text: pixMessage }] });
                            waitingForComprovante = true;
                        } else {
                            const errorMessage = `Hmm, amor... pra eu te mandar as fotos, preciso que seja em múltiplos de 5, tá? E no mínimo 5 fotos. Qual quantidade você gostaria? 😉`;
                            addTypingIndicator(); // Show typing for error message
                            await new Promise(resolve => setTimeout(resolve, Math.random() * 3000 + 2000));
                            removeTypingIndicator();
                            addMessage(errorMessage, 'suellen');
                            chatHistory.push({ role: "model", parts: [{ text: errorMessage }] });
                        }
                    }

                } else {
                    removeTypingIndicator();
                    addMessage("Desculpe, não entendi, amor. Pode repetir? 💋", 'suellen');
                    chatHistory.push({ role: "model", parts: [{ text: "Desculpe, não entendi, amor. Pode repetir? 💋" }] });
                }
            } catch (error) {
                console.error("Erro ao chamar a API Gemini:", error);
                removeTypingIndicator();
                addMessage("Ops! Deu um probleminha aqui, mas já estou resolvendo. Tenta de novo em um minutinho, tá? 😉", 'suellen');
                chatHistory.push({ role: "model", parts: [{ text: "Ops! Deu um probleminha aqui, mas já estou resolvendo. Tenta de novo em um minutinho, tá? 😉" }] });
            }
        }

        // Function to handle the simulated receipt
        function handleComprovante(message) {
            const parts = message.toLowerCase().split(' ');
            if (parts.length < 3) {
                addMessage("Hmm... parece que algo não tá certo aqui, viu? 💋 Confere o valor e o nome no comprovante pra mim, amor?", 'suellen');
                return;
            }

            const simulatedValue = parseFloat(parts[1].replace(',', '.'));
            const simulatedName = parts.slice(2).join(' ');

            const nameMatches = ['antonio', 'renimar', 'pinheiro', 'almeida'].some(name => simulatedName.includes(name));

            if (simulatedValue === expectedPaymentAmount && nameMatches) {
                addMessage("Pix confirmado, amor 😘... Aqui estão suas fotos 😈", 'suellen');
                sendPhotos(expectedPaymentAmount);
            } else {
                addMessage("Hmm... parece que algo não tá certo aqui, viu? 💋 Confere o valor e o nome no comprovante pra mim, amor?", 'suellen');
            }
        }

        // Function to send photos
        function sendPhotos(amountPaid) {
            const numPhotos = (amountPaid / 10) * 5; // Calculates the number of photos based on the amount paid
            
            // Ensures we don't send more than 100 photos in total
            const photosToSendThisBatch = Math.min(numPhotos, 100 - photosSentCount);

            if (photosToSendThisBatch > 0) {
                for (let i = 0; i < photosToSendThisBatch; i++) {
                    photosSentCount++;
                    const imageUrl = `https://placehold.co/300x400/FF007F/FFFFFF?text=Foto${photosSentCount}`;
                    addMessage('', 'suellen', true, imageUrl);
                }
                if (photosSentCount >= 100) {
                    addMessage("Acabou por hoje, meu bem. Mas fica por perto... logo logo eu volto com mais surpresas 🔥", 'suellen');
                }
            } else {
                // If there are no photos to send, or already sent 100
                if (photosSentCount >= 100) {
                     addMessage("Já te enviei todas as fotos que tinha por agora, amor. Mas logo logo tem mais! 😉", 'suellen');
                } else {
                    addMessage("Não consigo enviar essa quantidade de fotos agora, amor. Tenta um valor diferente? 💋", 'suellen');
                }
            }
        }


        // Event Listeners
        sendButton.addEventListener('click', () => {
            const message = chatInput.value.trim();
            if (message) {
                chatInput.value = '';
                processUserMessage(message);
            }
        });

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendButton.click();
            }
        });

        // Initial greeting from Suellen
        window.onload = () => {
            addTypingIndicator(); // Show typing indicator for the initial message
            setTimeout(() => {
                removeTypingIndicator();
                addMessage("Olá, meu bem! Que bom te ver por aqui... 😉 Como posso te encantar hoje?", 'suellen');
                chatHistory.push({ role: "model", parts: [{ text: "Olá, meu bem! Que bom te ver por aqui... 😉 Como posso te encantar hoje?" }] });
            }, 4000); // 4 seconds for the first message
        };
    </script>
</body>
</html>
