<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
    <title>Chat com Suellen</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0"></script>

    <style>
      html, body {
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', sans-serif;
        height: 100%;
        background-color: #ece5dd;
      }
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #1e1e2e;
      }
      .chat-container {
        width: 100%;
        height: 100dvh;
        max-width: 430px;
        background-color: #2a2a3a;
        display: flex;
        flex-direction: column;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
        position: relative;
        color: #f0f0f0;
      }
      .chat-header {
        background-color: #6a1b9a;
        padding: 10px 15px;
        display: flex;
        align-items: center;
        color: white;
        border-bottom: 1px solid #4a148c;
      }
      .chat-header img {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        margin-right: 12px;
        object-fit: cover;
        border: 2px solid #9c27b0;
      }
      .chat-header .name {
        font-size: 18px;
        font-weight: bold;
      }
      .chat-body {
        flex: 1;
        padding: 15px;
        overflow-y: auto;
        background-color: #2a2a3a;
        display: flex;
        flex-direction: column;
      }
      .message {
        max-width: 75%;
        padding: 10px 14px;
        margin-bottom: 8px;
        font-size: 15px;
        border-radius: 8px;
        line-height: 1.4;
        word-wrap: break-word;
      }
      .user {
        align-self: flex-end;
        background-color: #6a1b9a;
        border-bottom-right-radius: 0;
      }
      .bot {
        align-self: flex-start;
        background-color: #4a148c;
        border-bottom-left-radius: 0;
      }
      .typing-indicator {
        align-self: flex-start;
        background-color: #4a148c;
        border-bottom-left-radius: 0;
        max-width: 50px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        margin-bottom: 8px;
        padding: 5px 10px;
      }
      .typing-indicator span {
        display: inline-block;
        width: 6px;
        height: 6px;
        margin: 0 1px;
        background-color: #f0f0f0;
        border-radius: 50%;
        animation: blink 1.4s infinite both;
      }
      .typing-indicator span:nth-child(2) {
        animation-delay: 0.2s;
      }
      .typing-indicator span:nth-child(3) {
        animation-delay: 0.4s;
      }
      @keyframes blink {
        0%, 80%, 100% { opacity: 0; }
        40% { opacity: 1; }
      }
      .chat-footer {
        display: flex;
        padding: 8px 10px;
        background-color: #2a2a3a;
        border-top: 1px solid #4a148c;
        align-items: center;
        position: relative;
      }
      .chat-footer input {
        flex: 1;
        padding: 12px;
        border: none;
        font-size: 16px;
        border-radius: 20px;
        margin-right: 8px;
        background-color: #3a3a4a;
        outline: none;
        padding-left: 15px;
        color: #f0f0f0;
      }
      .chat-footer button#actionButton {
        width: 40px;
        height: 40px;
        background-color: #9c27b0;
        border: none;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background-color 0.3s;
      }
      .chat-footer button#actionButton:hover {
        background-color: #ab47bc;
      }
      .chat-footer button#actionButton img {
        width: 20px;
        height: 20px;
      }
      .option-buttons {
        display: flex;
        gap: 10px;
        margin-top: 10px;
        flex-wrap: wrap;
      }
      .option-button {
        background-color: #9c27b0;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.3s;
      }
      .option-button:hover {
        background-color: #ab47bc;
      }
      .preview-image {
        max-width: 100%;
        border-radius: 8px;
        margin-top: 10px;
        border: 2px solid #9c27b0;
      }
      .upload-label {
        display: inline-flex;
        align-items: center;
        padding: 8px 12px;
        background-color: #9c27b0;
        color: white;
        border-radius: 20px;
        cursor: pointer;
        margin-top: 10px;
        margin-right: 10px;
        font-size: 14px;
        gap: 6px;
        transition: background-color 0.3s;
      }
      .upload-label:hover {
        background-color: #ab47bc;
      }
      .upload-label img {
        width: 16px;
        height: 16px;
      }
      #uploadImage {
        display: none;
      }
      .photo-package {
        margin-top: 15px;
        padding: 10px;
        background-color: #3a3a4a;
        border-radius: 8px;
        text-align: center;
      }
      .photo-package img {
        max-width: 100%;
        border-radius: 8px;
        margin: 5px 0;
      }
      .flirt-button {
        background-color: #e91e63;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.3s;
        margin-top: 10px;
      }
      .flirt-button:hover {
        background-color: #f06292;
      }
      .mic-icon {
        position: absolute;
        left: 15px;
        width: 24px;
        height: 24px;
        cursor: pointer;
        animation: pulse 1.5s infinite ease-in-out;
        display: none;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }
      .bot-recording-indicator {
        background-color: white;
        padding: 8px 12px;
        border-radius: 8px;
        margin-bottom: 8px;
        align-self: flex-start;
        max-width: 40px;
        position: relative;
        box-shadow: 0 1px 1px rgba(0,0,0,0.1);
      }
      .bot-recording-indicator::after {
        content: '';
        position: absolute;
        left: -8px;
        top: 8px;
        width: 0;
        height: 0;
        border-top: 8px solid transparent;
        border-right: 8px solid white;
        border-bottom: 8px solid transparent;
      }
      .bot-recording-img {
        width: 32px;
        height: 32px;
        animation: pulse 1.5s infinite ease-in-out;
      }
      .user-recording-indicator {
        position: absolute;
        left: 35px;
        display: flex;
        align-items: center;
      }
      .user-recording-img {
        width: 24px;
        height: 24px;
        margin-right: 8px;
        animation: pulse 1.5s infinite ease-in-out;
      }
      .user-recording-time {
        font-size: 14px;
        color: #555;
        position: absolute;
        left: 45px;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }
      .attachment-button {
        background: none;
        border: none;
        cursor: pointer;
        margin-right: 8px;
      }
      .attachment-button img {
        width: 24px;
        height: 24px;
      }
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.3; }
      }
    </style>
  </head>
  <body>
    <div class="chat-container">
      <div class="chat-header">
        <img src="perfil.webp" alt="Perfil">
        <div class="name"><strong>Suellen Rocha</strong></div>
      </div>
      <div class="chat-body" id="chatBody"></div>
      <div class="chat-footer">
        <button class="attachment-button" id="attachButton">
          <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTE2LjUsNkMxNCwxNiAxMsMTYgNSwxN0w3LDE1TDE2LjUsNk0xOCw0TDIwLDZDMTksMjEgMTgsMjIgMTIsMTkuNUw5LjUsMTdMMTUsMTEuNUwxOCw0WiIvPjwvc3ZnPg==" alt="Anexar">
        </button>
        <input type="file" id="uploadImage" accept="image/*" style="display: none">
        <img src="gravaperson.webp" alt="Gravar" class="mic-icon" id="micIcon">
        <input type="text" id="userInput" placeholder="Digite sua mensagem..." oninput="updateActionIcon()" onkeypress="handleKeyPress(event)">
        <button id="actionButton" title="Gravar ou enviar">
          <img id="actionIcon" src="gravacao.webp" alt="Ícone">
        </button>
      </div>
    </div>

    <script>
      // Configuração do PDF.js
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';
      
      const PIX_KEY = '98981420070';
      const RECEIVER_NAME = 'Antonio Renimar Pinheiro Almeida';
      const PHOTOS_PER_PACKAGE = 5;
      
      let isWaitingResponse = false;
      let typingEl = null;
      let typingTimeout = null;
      let currentPhotoIndex = 1;
      let isWaitingPayment = false;
      let pipeline = null;
      let recognition;
      let userName = null;
      let conversationLevel = 0;
      let askedForName = false;
      const actionButton = document.getElementById('actionButton');
      const actionIcon = document.getElementById('actionIcon');
      const userInput = document.getElementById('userInput');
      const micIcon = document.getElementById('micIcon');
      const attachButton = document.getElementById('attachButton');
      const uploadImage = document.getElementById('uploadImage');
      let initialMessageSent = false;

      // Configuração do reconhecimento de voz
      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = 'pt-BR';
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.onstart = () => {
          micIcon.style.display = 'block';
          userInput.placeholder = '';
        };
        recognition.onend = () => {
          micIcon.style.display = 'none';
          userInput.placeholder = 'Digite sua mensagem...';
        };
        recognition.onresult = (event) => {
          const transcript = event.results[0][0].transcript;
          userInput.value = transcript;
          updateActionIcon();
          sendMessage();
        };
      }

      function updateActionIcon() {
        if (userInput.value.trim()) {
          actionIcon.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0id2hpdGUiPjxwYXRoIGQ9Ik0yLDExTDIyLDExTDEyLDIxTDEyLDMiLz48L3N2Zz4=';
        } else {
          actionIcon.src = 'gravacao.webp';
        }
      }

      actionButton.addEventListener('click', () => {
        if (userInput.value.trim()) {
          sendMessage();
        } else if (recognition) {
          try {
            recognition.start();
          } catch (e) {}
        }
      });

      attachButton.addEventListener('click', () => {
        uploadImage.click();
      });

      uploadImage.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
          handleImageUpload(e.target.files[0]);
        }
      });

      // Inicializar o modelo de reconhecimento de imagem
      async function initializeImageRecognition() {
        try {
          pipeline = await transformers.pipeline(
            'image-to-text',
            'Xenova/vit-gpt2-image-captioning'
          );
          console.log("Modelo de reconhecimento de imagem carregado");
        } catch (error) {
          console.error("Erro ao carregar modelo de reconhecimento de imagem:", error);
        }
      }
      
      // Carregar o modelo quando a página carregar
      window.onload = async () => {
        await initializeImageRecognition();
        
        // Enviar mensagem inicial após 2 segundos
        setTimeout(() => {
          if (!initialMessageSent && document.getElementById('chatBody').children.length === 0) {
            simulateTyping("Oiê, gato! Tudo bem com você? 😘", 2000);
            initialMessageSent = true;
          }
        }, 2000);
      };

      async function analyzeImage(imageData) {
        try {
          if (!pipeline) {
            await initializeImageRecognition();
          }
          
          const output = await pipeline(imageData);
          return output[0].generated_text;
        } catch (error) {
          console.error("Erro ao analisar imagem:", error);
          return null;
        }
      }

      async function handleImageUpload(file) {
        const reader = new FileReader();
        reader.onload = async function(e) {
          const imageData = e.target.result;
          
          const previewHTML = `
            <div>
              <img src="${imageData}" class="preview-image">
            </div>
          `;
          appendMessage("user", previewHTML);
          
          showTypingIndicator();
          const imageDescription = await analyzeImage(imageData);
          hideTypingIndicator();
          
          if (imageDescription) {
            if (imageDescription.toLowerCase().includes('penis') || 
                imageDescription.toLowerCase().includes('dick') || 
                imageDescription.toLowerCase().includes('pau')) {
              // Resposta para foto de pau
              const responses = [
                "Nossa, que pau gostoso... 🤤 Me deixa com vontade de brincar com ele... 😈",
                "Hmm, que delícia de pau... Já estou imaginando ele dentro de mim... 🥵",
                "Que tesão de pau! Me deixa toda molhadinha só de imaginar ele me comendo... 💦",
                "Nossa, com um pau desses eu ia ficar de quatro na hora... Quero sentir ele todinho dentro de mim! 😫"
              ];
              
              const randomResponse = responses[Math.floor(Math.random() * responses.length)];
              await simulateTyping(randomResponse, 1500);
              
              // Oferecer fotos após ver foto de pau
              await simulateTyping("Quer ver umas fotos minhas bem gostosas? Me manda quanto você quer pagar que eu te mando umas coisinhas especiais... 😏", 2000);
            } else {
              // Resposta para outras fotos
              const responses = [
                `Adorei o que vejo... ${imageDescription.toLowerCase()} é tão excitante, não acha? 😏`,
                `Hmm, ${imageDescription.toLowerCase()}... Você sabe como deixar uma garota curiosa, hein? 😉`,
                `Que interessante... ${imageDescription.toLowerCase()} me faz imaginar tantas possibilidades... 😈`,
                `Você tem bom gosto! ${imageDescription.toLowerCase()} é algo que realmente me chama atenção... 😘`
              ];
              
              const randomResponse = responses[Math.floor(Math.random() * responses.length)];
              await simulateTyping(randomResponse, 1500);
              
              // Perguntar o nome de forma natural
              if (!userName) {
                await simulateTyping("Qual é o seu nome mesmo, meu bem? ☺️", 1500);
              } else {
                await simulateTyping(`${userName}, quer ver umas fotos minhas bem gostosas? Me diz quanto quer pagar que eu te mando umas coisinhas... 😏`, 2000);
              }
            }
          } else {
            // Caso não consiga analisar a imagem
            await simulateTyping("Que imagem interessante... Me conta mais sobre isso? 😊", 1500);
            
            if (!userName) {
              await simulateTyping("Aliás, qual é o seu nome mesmo, gato? ☺️", 1500);
            }
          }
        };
        reader.readAsDataURL(file);
      }

      function handleKeyPress(event) {
        if (event.key === 'Enter' && !isWaitingResponse) {
          sendMessage();
        }
      }

      async function sendMessage() {
        if (isWaitingResponse) return;
        const text = userInput.value.trim();
        if (!text) return;
        
        appendMessage("user", text);
        userInput.value = "";
        updateActionIcon();
        isWaitingResponse = true;
        
        setTimeout(() => {
          showTypingIndicator();
          processUserMessage(text);
        }, 800);
      }

      async function processUserMessage(text) {
        const lower = text.toLowerCase();
        const normalized = lower.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
        
        // Captura do nome do usuário de forma natural
        if (!userName) {
          if (askedForName) {
            // Se já perguntou o nome, assume que a resposta é o nome
            userName = text.split(' ')[0]; // Pega a primeira palavra como nome
            await simulateTyping(`Prazer em te conhecer, ${userName}! 😊 Me conta, o que te trouxe aqui hoje?`, 1500);
            conversationLevel = 1;
            isWaitingResponse = false;
            return;
          } else {
            // Primeira vez perguntando o nome
            askedForName = true;
            await simulateTyping("Qual é o seu nome mesmo, meu bem? ☺️", 1500);
            isWaitingResponse = false;
            return;
          }
        }
        
        // Respostas sobre informações pessoais
        if (normalized.includes('quantos anos') || normalized.includes('idade')) {
          await simulateTyping("Eu tenho 25 anos, meu amor! Estou no auge da minha beleza e energia! 😘", 1200);
          isWaitingResponse = false;
          conversationLevel = Math.min(conversationLevel + 1, 5);
          return;
        }
        
        if (normalized.includes('onde mora') || normalized.includes('de onde') || normalized.includes('cidade')) {
          await simulateTyping("Eu moro em Florianópolis, Santa Catarina agora, mas nasci em Cachoeira de Itabuna, na Bahia! Adoro a praia aqui em Floripa! 🌊😊", 1500);
          isWaitingResponse = false;
          conversationLevel = Math.min(conversationLevel + 1, 5);
          return;
        }
        
        if (normalized.includes('solteira') || normalized.includes('namora') || normalized.includes('casada')) {
          await simulateTyping(`Estou solteira e pronta para me divertir! 😉 E você, ${userName}, também está solteiro?`, 1500);
          isWaitingResponse = false;
          conversationLevel = Math.min(conversationLevel + 1, 5);
          return;
        }
        
        // Detecção de pedido de fotos ou valores
        const priceMatch = normalized.match(/(\d+)\s*(reais|rs|r\$|pila|contos|fotos?|pacotes?|fts?)/i);
        if (priceMatch) {
          const value = parseInt(priceMatch[1]);
          if (value > 0) {
            const packages = Math.ceil(value / 10); // Assume R$10 por pacote
            const quantity = packages * PHOTOS_PER_PACKAGE;
            
            await simulateTyping(`Ahh, ${userName}, com R$${value} eu te mando ${quantity} fotinhas bem gostosas... 😏`, 1500);
            await simulateTyping(`Me faz um Pix de R$${value} pra essa chave aqui e eu já mando tudo pra você, tá bom? 😘`, 1500);
            
            const pixInfoHTML = `
              <div style="background-color: #3a3a4a; padding: 15px; border-radius: 10px; margin-top: 10px;">
                <p><strong>📌 Chave Pix (CPF):</strong> ${PIX_KEY}</p>
                <p><strong>📌 Nome:</strong> ${RECEIVER_NAME}</p>
                <p><strong>💰 Valor:</strong> R$ ${value},00</p>
                <p style="margin-top: 10px;">Depois que o Pix cair, me manda o comprovante que eu te mando as fotinhas na hora! Prometo que vale a pena... 😈</p>
              </div>
              <div style="margin-top: 15px;">
                <label for="uploadImage" class="upload-label">
                  <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0id2hpdGUiPjxwYXRoIGQ9Ik00LDVIMjBWMThINFY1TTUsOEEyLDggMiA4QTIsMiAwIDAgMSA1LDZBMiwyIDAgMCwxIDcsOEEyLDIgMCAwLDEgNSwxMEEyLDIgMCAwLDEgMyw4QTIsMiAwIDAsMSA1LDZNNSwxMkwyMSwxMlYxOUg1VjEyWiIvPjwvc3ZnPg==" alt="Enviar imagem" />
                  Enviar Comprovante
                </label>
              </div>
            `;
            
            appendMessage("bot", pixInfoHTML);
            
            isWaitingPayment = true;
            isWaitingResponse = false;
            return;
          }
        }
        
        // Elogios ou mensagens sensuais
        const isFlirtyMessage = normalized.includes('gostosa') || normalized.includes('linda') || 
                               normalized.includes('bela') || normalized.includes('sexy') ||
                               normalized.includes('delícia') || normalized.includes('maravilhosa') ||
                               normalized.includes('tesão') || normalized.includes('gata') ||
                               normalized.includes('gostosura') || normalized.includes('perfeita');
        
        if (isFlirtyMessage) {
          const responses = [
            "Hmm... você sabe como elogiar uma garota, né? Me deixa toda arrepiada... 😏",
            "Nossa, com esses elogios você está me deixando com vontade de te mostrar mais... 😘",
            "Que delícia de elogio! Você me deixa toda molhadinha... 💦",
            "Adoro quando me elogiam assim... me dá umas ideias... rsrs 😈"
          ];
          
          await simulateTyping(responses[Math.floor(Math.random() * responses.length)], 1500);
          
          // Oferecer fotos após elogio (50% de chance)
          if (Math.random() > 0.5) {
            await simulateTyping(`${userName}, quer ver umas fotos minhas bem gostosas? Me diz quanto quer pagar que eu te mando umas coisinhas... 😏`, 2000);
          }
          
          isWaitingResponse = false;
          conversationLevel = Math.min(conversationLevel + 1, 5);
          return;
        }
        
        // Resposta padrão baseada no nível da conversa
        await generateAppropriateResponse(text);
        isWaitingResponse = false;
      }

      async function generateAppropriateResponse(text) {
        const responsesByLevel = [
          // Nível 0-1: Respostas iniciais
          [
            `Que legal conversar com você, ${userName}! O que você gosta de fazer no seu tempo livre? 😊`,
            `Adoro conhecer pessoas novas como você, ${userName}. Me conta mais sobre você! 😘`,
            `${userName}, você parece ser muito interessante! O que te trouxe pra conversar comigo hoje? 😉`,
            `Eu adoro conversar, ${userName}! Me conta, qual seu signo? 😊`
          ],
          // Nível 2: Respostas mais pessoais
          [
            `Hmm, gosto do jeito que você conversa, ${userName}... Me deixa curiosa pra saber mais sobre você! 😉`,
            `Você tem um jeito tão cativante de falar, ${userName}... Me conta, o que te faz feliz? 😘`,
            `Nossa, com essa conversa você está me deixando com vontade de te conhecer melhor, ${userName}... 😏`,
            `Adoro essa conexão que estamos criando, ${userName}... Você é tão interessante! 😊`
          ],
          // Nível 3: Respostas provocantes
          [
            `Você sabe como manter uma garota interessada, não é, ${userName}? Me diz, o que mais você quer saber? 😉`,
            `Hmm, com esse papo você está me deixando com vontade de te mostrar umas coisinhas... Quer ver, ${userName}? 😘`,
            `Nossa, ${userName}, só de imaginar nossa conversa me dá umas ideias... rsrs 😏`,
            `Você tem um jeito tão envolvente, ${userName}... Me deixa com vontade de me aproximar mais! 😊`
          ],
          // Nível 4: Respostas sensuais
          [
            `Eu quero gozar... 😏🤤`,
            `Tô louca pra sentar no seu pau... 😈🔥`,
            `Quero te dar de todas as formas possíveis... 🥵`,
            `Quero ficar de quatro pra você... 😏`
          ],
          // Nível 5: Respostas explícitas
          [
            `Quero ver teu pau... Manda uma foto pra mim? 🤤`,
            `Nossa, só de imaginar você me comendo já fico toda molhada... 💦`,
            `Você me deixa com tanto tesão que até me tremo toda... 😫`,
            `Quero sentir você dentro de mim até eu gozar... 🥴`
          ]
        ];
        
        const level = Math.min(conversationLevel, responsesByLevel.length - 1);
        const responses = responsesByLevel[level];
        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        
        await simulateTyping(randomResponse, 1500 + Math.random() * 1000);
        
        // Aumentar o nível da conversa gradualmente
        if (Math.random() > 0.7) {
          conversationLevel = Math.min(conversationLevel + 1, 5);
        }
        
        // Oferecer fotos se o nível for alto
        if (conversationLevel >= 2 && Math.random() > 0.6) {
          await simulateTyping(`${userName}, quer ver umas fotos minhas bem gostosas? Me diz quanto quer pagar que eu te mando umas coisinhas... 😏`, 2000);
        }
      }

      function showTypingIndicator() {
        if (!typingEl) {
          typingEl = document.createElement("div");
          typingEl.className = "typing-indicator";
          typingEl.innerHTML = "<span></span><span></span><span></span>";
          document.getElementById("chatBody").appendChild(typingEl);
          document.getElementById("chatBody").scrollTop = document.getElementById("chatBody").scrollHeight;
        }
      }

      function hideTypingIndicator() {
        if (typingEl) {
          typingEl.remove();
          typingEl = null;
        }
        if (typingTimeout) {
          clearTimeout(typingTimeout);
          typingTimeout = null;
        }
      }

      async function simulateTyping(message, duration = 1500) {
        const typingTime = Math.min(Math.max(message.length * 30, 1000), duration);
        showTypingIndicator();
        await new Promise(r => setTimeout(r, typingTime));
        hideTypingIndicator();
        if (message) {
          appendMessage("bot", message);
        }
      }

      function appendMessage(sender, message) {
        const chatBody = document.getElementById("chatBody");
        const msgEl = document.createElement("div");
        msgEl.className = `message ${sender}`;
        msgEl.innerHTML = message;
        chatBody.appendChild(msgEl);
        chatBody.scrollTop = chatBody.scrollHeight;
      }
    </script>
  </body>
</html>
